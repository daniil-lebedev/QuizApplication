{% extends 'base/base.html' %}
{% block title %} User Profile {% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="display-4">Hello, {{ user.first_name }} {{ user.last_name }}</h1>

    <h3>Quizzes Created by You</h3>
    <div class="row">
        {% for quiz in quizzes %}
        <div class="col-md-6 mb-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ quiz.title }}</h5>
                    <p class="card-text">{{ quiz.description|truncatewords:20 }}</p>
                    <p class="text-muted">Due: {{ quiz.due_date|date:"F d, Y" }}</p>
                    <a href="{% url 'view_quiz' quiz.id %}" class="btn btn-primary">View Quiz</a>
                    <a href="{% url 'view_quiz_analysis' quiz.id quiz.belongs_to.id%}" class="btn btn-primary">View Quiz Results</a>
                    <a href="{% url 'quiz_management' quiz.id %}" class="btn btn-secondary">Manage Quiz</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No quizzes found.</p>
        {% endfor %}
    </div>

    <h3>Teams You Are an Admin Of</h3>
    <div class="row">
        {% for team_admin in user.team_admins.all %}
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ team_admin.name }}</h5>
                    <p class="card-text">{{ team_admin.description|truncatewords:20 }}</p>
                    <a href="{% url 'edit_team' team_admin.id %}" class="btn btn-primary">Edit Team</a>
                    <a href="{% url 'team_detail' team_admin.id %}" class="btn btn-info">View Team</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No teams to manage.</p>
        {% endfor %}
    </div>

    <h3>Teams You Are a Member Of</h3>
    <div class="row">
        {% for team_member in user_teams_member_of %}
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ team_member.name }}</h5>
                    <p class="card-text">Created at: {{ team_member.created_at|date:"F d, Y" }}</p>
                    <a href="{% url 'team_detail' team_member.id %}" class="btn btn-info">View Team</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>You are not a member of any teams.</p>
        {% endfor %}
    </div>

    <h3>Boards You Have Created</h3>
    <div class="row">
        {% for board in boards %}
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ board.title }}</h5>
                    <p class="card-text">{{ board.description|truncatewords:20 }}</p>
                    <a href="{% url 'board_detail' board.id %}" class="btn btn-success">View Board</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No educational boards found.</p>
        {% endfor %}
    </div>

    <h3>Your Results</h3>
    <div class="row">
        {% for result in results %}
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">{{ result.quiz.title }}</h5>
                    <p class="card-text">Score: {{ result.score }}/{{ result.quiz.points }}</p>
                    <p class="text-muted">Completed: {{ result.date_taken|date:"F d, Y H:i" }}</p>
                    <a href="{% url 'view_result' result.quiz_id result.user.team.id %}" class="btn btn-primary">View Result</a>
                </div>
            </div>
        </div>
        {% empty %}
        <p>No quiz results to show.</p>
        {% endfor %}
    </div>

    <a href="{% url 'user_logout' %}" class="btn btn-danger mt-4">Logout</a>
</div>
{% endblock %}
